---
title: "220 Project"
author: "Alex Fan"
date: "11/25/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

```{r}
library(readr)
library(tidyverse)
library(stargazer)
dat <- read_csv("dat.csv")
```

# Clean the data and make model spec. variables
```{r}
head(dat)

dat$age2 <- dat$age^2
dat$srvlng2 <- dat$srvlng^2
dat$rgroup <- factor(dat$rgroup)
prop.table(table(dat$rgroup))
levels(dat$rgroup) <- c("None", "Protestant", "Catholic", "Other Christian", "Other religion")
dat$rgroup <- factor(dat$rgroup, levels = c("Protestant", "None", "Catholic", "Other Christian", "Other religion"))

```

# Model with NOW data
```{r}
datNOW <- dat %>%
  filter(congress == 105)

summary(datNOW)
lm.1 <- lm(nowtot ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datNOW)
summary(lm.1)
```

# Model with AAUW 105th Congress
```{r}
datAAUW105 <- dat %>%
  filter (congress == 105)
lm.2 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW105)
summary(lm.2)
```

# Model with AAUW 106th Congress
```{r}
datAAUW106 <- dat %>%
  filter (congress == 106)
lm.3 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW106)
summary(lm.3)
```

# Model with AAUW 107th Congress
```{r}
datAAUW107 <- dat %>%
  filter (congress == 107)
lm.4 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW107)
summary(lm.4)
```

# Model with AAUW 107th Congress
```{r}
datAAUW108 <- dat %>%
  filter (congress == 108)
lm.5 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW108)
summary(lm.5)
```

# Put all models in a stargazer table
```{r, results = "hide"}
stargazer(lm.1, lm.2, lm.3, lm.4, lm.5)
```

\begin{tabular}{@{\extracolsep{5pt}}lcc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{2}{c}{\textit{Dependent variable:}} \\ 
\cline{2-3} 
\\[-1.8ex] & nowtot & aauw \\ 
\\[-1.8ex] & (1) & (2)\\ 
\hline \\[-1.8ex] 
 ngirls & 2.300$^{**}$ & 2.385$^{**}$ \\ 
  & (1.038) & (1.124) \\ 
  & & \\ 
 female & 10.838$^{***}$ & 9.194$^{***}$ \\ 
  & (2.690) & (2.910) \\ 
  & & \\ 
 white & 1.860 & 0.144 \\ 
  & (3.451) & (3.676) \\ 
  & & \\ 
 repub & $-$44.903$^{***}$ & $-$60.468$^{***}$ \\ 
  & (2.109) & (2.280) \\ 
  & & \\ 
 age & 0.661 & 0.854 \\ 
  & (0.800) & (0.860) \\ 
  & & \\ 
 age2 & $-$0.006 & $-$0.006 \\ 
  & (0.008) & (0.008) \\ 
  & & \\ 
 srvlng & 0.235 & $-$0.208 \\ 
  & (0.300) & (0.324) \\ 
  & & \\ 
 srvlng2 & $-$0.009 & 0.004 \\ 
  & (0.010) & (0.011) \\ 
  & & \\ 
 rgroupNone & 7.262 & 5.671 \\ 
  & (7.022) & (7.606) \\ 
  & & \\ 
 rgroupCatholic & $-$3.974$^{**}$ & $-$4.505$^{**}$ \\ 
  & (1.941) & (2.091) \\ 
  & & \\ 
 rgroupOther Christian & 0.769 & 3.204 \\ 
  & (4.600) & (4.983) \\ 
  & & \\ 
 rgroupOther religion & 10.866$^{***}$ & 9.683$^{**}$ \\ 
  & (3.752) & (4.047) \\ 
  & & \\ 
 demvote & 84.158$^{***}$ & 62.148$^{***}$ \\ 
  & (10.869) & (11.568) \\ 
  & & \\ 
 factor(totchi)1 & $-$3.278 & $-$3.497 \\ 
  & (3.497) & (3.739) \\ 
  & & \\ 
 factor(totchi)2 & $-$5.524$^{*}$ & $-$4.409 \\ 
  & (2.821) & (3.038) \\ 
  & & \\ 
 factor(totchi)3 & $-$7.370$^{**}$ & $-$7.397$^{**}$ \\ 
  & (3.273) & (3.526) \\ 
  & & \\ 
 factor(totchi)4 & $-$11.012$^{***}$ & $-$10.872$^{***}$ \\ 
  & (3.779) & (4.062) \\ 
  & & \\ 
 factor(totchi)5 & $-$10.274$^{**}$ & $-$13.036$^{**}$ \\ 
  & (4.719) & (5.094) \\ 
  & & \\ 
 factor(totchi)6 & $-$12.454 & $-$17.865$^{**}$ \\ 
  & (8.279) & (8.953) \\ 
  & & \\ 
 factor(totchi)7 & $-$10.634 & $-$11.857 \\ 
  & (9.583) & (10.377) \\ 
  & & \\ 
 factor(totchi)8 & $-$28.974$^{**}$ & $-$43.703$^{***}$ \\ 
  & (11.297) & (12.226) \\ 
  & & \\ 
 factor(totchi)9 & $-$14.077 & $-$15.929 \\ 
  & (17.660) & (19.124) \\ 
  & & \\ 
 factor(totchi)10 & $-$23.045 & $-$26.659 \\ 
  & (17.220) & (18.647) \\ 
  & & \\ 
 factor(region)2 & $-$11.884$^{***}$ & $-$9.287$^{**}$ \\ 
  & (4.096) & (4.409) \\ 
  & & \\ 
 factor(region)3 & $-$13.047$^{***}$ & $-$12.577$^{***}$ \\ 
  & (4.086) & (4.422) \\ 
  & & \\ 
 factor(region)4 & $-$13.587$^{***}$ & $-$7.870 \\ 
  & (4.702) & (5.087) \\ 
  & & \\ 
 factor(region)5 & $-$11.358$^{***}$ & $-$10.056$^{**}$ \\ 
  & (4.222) & (4.565) \\ 
  & & \\ 
 factor(region)6 & $-$22.281$^{***}$ & $-$19.686$^{***}$ \\ 
  & (4.985) & (5.394) \\ 
  & & \\ 
 factor(region)7 & $-$17.820$^{***}$ & $-$15.546$^{***}$ \\ 
  & (4.524) & (4.888) \\ 
  & & \\ 
 factor(region)8 & $-$15.108$^{***}$ & $-$16.451$^{***}$ \\ 
  & (5.036) & (5.451) \\ 
  & & \\ 
 factor(region)9 & $-$8.186$^{**}$ & $-$8.657$^{*}$ \\ 
  & (4.100) & (4.433) \\ 
  & & \\ 
 Constant & 17.025 & 36.451 \\ 
  & (21.662) & (23.401) \\ 
  & & \\ 
\hline \\[-1.8ex] 
Observations & 430 & 434 \\ 
R$^{2}$ & 0.820 & 0.840 \\ 
Adjusted R$^{2}$ & 0.806 & 0.828 \\ 
Residual Std. Error & 16.093 (df = 398) & 17.441 (df = 402) \\ 
F Statistic & 58.436$^{***}$ (df = 31; 398) & 68.061$^{***}$ (df = 31; 402) \\ 
\hline 
\hline \\[-1.8ex] 
\textit{Note:}  & \multicolumn{2}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\end{tabular} 
\end{table} 