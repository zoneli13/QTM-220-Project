---
title: "220 Project"
author: "Alex Fan"
date: "11/25/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

```{r}
library(readr)
library(tidyverse)
library(stargazer)
dat <- read_csv("dat.csv")
```

# Clean the data and make model spec. variables
```{r}
head(dat)

dat$age2 <- dat$age^2
dat$srvlng2 <- dat$srvlng^2
dat$rgroup <- factor(dat$rgroup)
prop.table(table(dat$rgroup))
levels(dat$rgroup) <- c("None", "Protestant", "Catholic", "Other Christian", "Other religion")
dat$rgroup <- factor(dat$rgroup, levels = c("Protestant", "None", "Catholic", "Other Christian", "Other religion"))

```

# Model with NOW data
```{r}
datNOW <- dat %>%
  filter(congress == 105)

summary(datNOW)
lm.1 <- lm(nowtot ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datNOW)
summary(lm.1)
```

# Model with AAUW 105th Congress
```{r}
datAAUW105 <- dat %>%
  filter (congress == 105)
lm.2 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW105)
summary(lm.2)
```

# Model with AAUW 106th Congress
```{r}
datAAUW106 <- dat %>%
  filter (congress == 106)
lm.3 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW106)
summary(lm.3)
```

# Model with AAUW 107th Congress
```{r}
datAAUW107 <- dat %>%
  filter (congress == 107)
lm.4 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW107)
summary(lm.4)
```

# Model with AAUW 107th Congress
```{r}
datAAUW108 <- dat %>%
  filter (congress == 108)
lm.5 <- lm(aauw ~ ngirls + female + white + repub + age + age2 + srvlng + srvlng2 + rgroup + demvote + factor(totchi) + factor(region), data = datAAUW108)
summary(lm.5)
```

# Put all models in a stargazer table
```{r, results = "hide"}
stargazer(lm.1, lm.2, lm.3, lm.4, lm.5, title = "Table 2—Impact of Female Children on Legislator Voting on Women’s Issues")
```

\begin{table}[!htbp] \centering 
  \caption{Replication of Table 2—Impact of Female Children on Legislator Voting on Women’s Issues} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}}lccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{5}{c}{\textit{Dependent variable:}} \\ 
\cline{2-6} 
\\[-1.8ex] & NOW & \multicolumn{4}{c}{AAUW} \\ 
\\[-1.8ex] & 105th & 105th & 106th & 107th & 108th \\ 
\\[-1.8ex] & (1) & (2) & (3) & (4) & (5)\\ 
\hline \\[-1.8ex] 
 Number of female children & 2.300$^{**}$ & 2.385$^{**}$ & 1.688 & 2.421$^{**}$ & 2.250$^{*}$ \\ 
  & (1.038) & (1.124) & (1.136) & (1.092) & (1.145) \\ 
  & & & & & \\ 
 Female & 10.838$^{***}$ & 9.194$^{***}$ & 10.440$^{***}$ & 7.564$^{***}$ & 6.909$^{**}$ \\ 
  & (2.690) & (2.910) & (2.881) & (2.618) & (2.730) \\ 
  & & & & & \\ 
 White & 1.860 & 0.144 & 2.594 & $-$2.626 & 1.939 \\ 
  & (3.451) & (3.676) & (3.833) & (3.150) & (3.211) \\ 
  & & & & & \\ 
 Republican & $-$44.903$^{***}$ & $-$60.468$^{***}$ & $-$55.927$^{***}$ & $-$63.216$^{***}$ & $-$63.932$^{***}$ \\ 
  & (2.109) & (2.280) & (2.335) & (2.120) & (2.436) \\ 
  & & & & & \\ 
 Age & 0.661 & 0.854 & 2.034$^{**}$ & 1.298 & 2.300$^{***}$ \\ 
  & (0.800) & (0.860) & (0.902) & (0.799) & (0.860) \\ 
  & & & & & \\ 
 Age squared & $-$0.006 & $-$0.006 & $-$0.018$^{**}$ & $-$0.012 & $-$0.021$^{**}$ \\ 
  & (0.008) & (0.008) & (0.009) & (0.007) & (0.008) \\ 
  & & & & & \\ 
 Service Length & 0.235 & $-$0.208 & $-$0.726$^{*}$ & $-$0.100 & $-$0.139 \\ 
  & (0.300) & (0.324) & (0.380) & (0.346) & (0.327) \\ 
  & & & & & \\ 
 Service length squared & $-$0.009 & 0.004 & 0.025$^{*}$ & $-$0.0002 & 0.004 \\ 
  & (0.010) & (0.011) & (0.013) & (0.011) & (0.010) \\ 
  & & & & & \\ 
 No religion & 7.262 & 5.671 & 5.353 & 7.027 & $-$7.137 \\ 
  & (7.022) & (7.606) & (7.791) & (7.176) & (7.499) \\ 
  & & & & & \\ 
 Catholic & $-$3.974$^{**}$ & $-$4.505$^{**}$ & $-$2.277 & $-$4.016$^{**}$ & $-$5.468$^{***}$ \\ 
  & (1.941) & (2.091) & (2.129) & (1.987) & (2.077) \\ 
  & & & & & \\ 
 Other Christian & 0.769 & 3.204 & 1.690 & 1.646 & 3.874 \\ 
  & (4.600) & (4.983) & (4.912) & (4.491) & (4.684) \\ 
  & & & & & \\ 
 Other religion & 10.866$^{***}$ & 9.683$^{**}$ & 11.890$^{***}$ & 10.286$^{***}$ & 3.156 \\ 
  & (3.752) & (4.047) & (4.343) & (3.785) & (3.959) \\ 
  & & & & & \\ 
 Democratic vote share in district & 84.158$^{***}$ & 62.148$^{***}$ & 57.437$^{***}$ & 56.206$^{***}$ & 66.950$^{***}$ \\ 
  & (10.869) & (11.568) & (12.018) & (9.092) & (10.889) \\ 
  & & & & & \\ 
\hline \\[-1.8ex] 
N & 430 & 434 & 434 & 434 & 433 \\ 
\hline 
\hline \\[-1.8ex] 
\textit{Note:}  & \multicolumn{5}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\end{tabular} 
\end{table}

# Table 3 shenanigans
## NOW all legislators
```{r}
lm_all_NOW<-lm(nowtot~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datNOW)
summary(lm_all_NOW)
```

## NOW Men only
```{r}
lm_men_NOW <- lm(nowtot~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datNOW, subset=female==0)
summary(lm_men_NOW)
```

## NOW Women only
```{r}
lm_women_NOW <- lm(nowtot~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datNOW, subset=female==1)
summary(lm_women_NOW)
```

## NOW Dems only
```{r}
lm_Dem_NOW <- lm(nowtot~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datNOW, subset=repub==0)
summary(lm_Dem_NOW)
```

## NOW Repubs only
```{r}
lm_Repub_NOW <- lm(nowtot~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datNOW, subset=repub==1)
summary(lm_Repub_NOW)
```

## AAUW All
```{r}
lm_all_AAUW <- lm(aauw~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datAAUW105)
summary(lm_all_AAUW)
```

## AAUW Men only
```{r}
lm_men_AAUW <- lm(aauw~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datAAUW105, subset = female == 0)
summary(lm_men_AAUW)
```

## AAUW Women only
```{r}
lm_women_AAUW <- lm(aauw~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datAAUW105, subset = female == 1)
summary(lm_women_AAUW)
```

## AAUW Dems only
```{r}
lm_Dem_AAUW <- lm(aauw~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datAAUW105, subset = repub == 0)
summary(lm_Dem_AAUW)
```

## AAUW Repubs only
```{r}
lm_Repub_AAUW <- lm(aauw~ngirls + female + white + repub + age + age2 + srvlng + srvlng2+ rgroup + demvote + factor(totchi) + factor(region),data=datAAUW105, subset = repub == 1)
summary(lm_Repub_AAUW)
```